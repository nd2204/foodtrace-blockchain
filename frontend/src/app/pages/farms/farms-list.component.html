<div class="page">
  <header class="page-header">
    <div>
      <h1>{{ 'PAGES.FARMS.TITLE' | translate }}</h1>
    </div>

    <div class="page-actions">
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input
          type="text"
          [placeholder]="'COMMON.Search' | translate"
          [(ngModel)]="searchTerm"
          (keyup.enter)="onSearch()"
        >
      </div>

      <button class="btn-secondary btn-filter" (click)="toggleFilter()" [class.active]="isFilterVisible">
        <span class="icon">üå™Ô∏è</span> {{ 'COMMON.FILTER' | translate }}
      </button>

      <button class="btn-primary" routerLink="/farms/create">
        <span class="icon">Ôºã</span> {{ 'PAGES.FARMS.BTN_ADD' | translate }}
      </button>
    </div>
  </header>

  <div class="filter-container" *ngIf="isFilterVisible">
    <div class="filter-header">
      <h3>{{ 'COMMON.FILTER' | translate }}</h3>
      <button class="close-filter" (click)="isFilterVisible = false">‚úï</button>
    </div>
    <div class="filter-row">
      <input type="text" class="form-control" placeholder="T√™n n√¥ng tr·∫°i" [(ngModel)]="filter.name">
      <input type="text" class="form-control" placeholder="Ch·ªß s·ªü h·ªØu" [(ngModel)]="filter.owner">
      <input type="text" class="form-control" placeholder="T·ªânh/Th√†nh" [(ngModel)]="filter.province">
      <select class="form-control" [(ngModel)]="filter.status">
        <option value="">-- Tr·∫°ng th√°i --</option>
        <option value="active">Active</option>
        <option value="inactive">Inactive</option>
      </select>
    </div>
    <div class="filter-actions">
      <button class="btn-reset" (click)="resetFilter()">{{ 'COMMON.RESET' | translate }}</button>
      <button class="btn-search-blue" (click)="onSearch()">{{ 'COMMON.APPLY' | translate }}</button>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>{{ 'PAGES.FARMS.TH_ID' | translate }}</th>
        <th>{{ 'PAGES.FARMS.TH_NAME' | translate }}</th>
        <th>{{ 'PAGES.FARMS.TH_PROVINCE' | translate }}</th>
        <th>{{ 'PAGES.FARMS.TH_OWNER' | translate }}</th>
        <th>{{ 'PAGES.FARMS.TH_STATUS' | translate }}</th>
        <th class="text-center">{{ 'COMMON.ACTIONS' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let f of farms">
        <td>{{ f.farm_id }}</td>
        <td><strong>{{ f.name }}</strong></td>
        <td>{{ f.address }}</td>
        <td>{{ f.owner_name }}</td>
        <td>
           <span class="badge" [ngClass]="(f.is_active) ? 'badge-active' : 'badge-inactive'">
             {{ f.is_active ? 'Active' : 'Inactive' }}
           </span>
        </td>
        <td class="text-center relative-cell">
          <button class="action-btn" (click)="toggleMenu(f.farm_id, $event)">‚ãÆ</button>
          <div class="action-menu" *ngIf="openDropdownId === (f.farm_id)" (click)="$event.stopPropagation()">
            <button class="menu-item" (click)="editFarm(f.farm_id)">‚úèÔ∏è {{ 'COMMON.EDIT' | translate }}</button>
            <button class="menu-item delete" (click)="deleteFarm(f.farm_id)">üóë {{ 'COMMON.DELETE' | translate }}</button>
          </div>
        </td>
      </tr>
      <tr *ngIf="farms.length === 0">
        <td colspan="6" class="empty-state">Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu.</td>
      </tr>
    </tbody>
  </table>
</div>
